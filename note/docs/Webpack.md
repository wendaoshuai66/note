#å¸¸ç”¨çš„å‰ç«¯æ„å»ºå·¥å…·-Webpack

##å‰ç«¯æ¨¡å—åŒ–çš„æ‰“åŒ…å·¥å…·

Webpackå‰ç«¯æ¨¡å—åŒ–çš„æ‰“åŒ…å·¥å…·ã€‚å®ƒå°†æ¯ä¸€ä¸ªé™æ€æ–‡ä»¶å½“åšä¸€ä¸ªæ¨¡å—ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†ä¸ºæˆ‘ä»¬æ•´åˆå‡ºæœ€åçš„éœ€è¦çš„jsã€cssã€å›¾ç‰‡ã€å­—ä½“ç­‰æ–‡ä»¶ã€‚

æ¨¡å—åŒ–æ˜¯ä¸€ç§å°†ç³»ç»Ÿåˆ†ç¦»æˆç‹¬ç«‹çš„åŠŸèƒ½éƒ¨åˆ†çš„æ–¹æ³•ï¼Œä¸¥æ ¼å®šä¹‰æ¨¡å—æ¥å£ã€æ¨¡å—é—´å…·æœ‰é€æ˜ã€‚

###æ¨¡å—åŒ–å†å²

1.æ— æ¨¡å—æ—¶ä»£

å…¨å±€å˜é‡æ³›æ»¥ã€å‘½åå†²çªã€ä¾èµ–å…³ç³»ç®¡ç†

2.æ¨¡å—èŒèŠ½æ—¶ä»£

ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰

ç»å…¸çš„ä¾‹å­jqï¼š

```
(function(window){


   window.jQuery = window.$ = jQuery;
})(window))
```

3.ç°ä»£åŒ–æ¨¡å—


 (1.)CommonJs (é€šè¿‡requireå¼•å…¥)

ï¼ˆ2.ï¼‰RequireJsï¼ˆAMDï¼‰/ SeaJs ï¼ˆCMDï¼‰ 
[å‚è€ƒ](https://www.zhihu.com/question/20351507/answer/14859415)


ï¼ˆ3.ï¼‰ES6 Moudle

## ä¸ºä»€ä¹ˆç”¨webpack

ä¸€å¥ç©ç¬‘è¯å› ä¸º Vue React ç«ğŸ”¥


###ä»€ä¹ˆæ˜¯Webpack

webpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚

Webpackæ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œåœ¨Webpacké‡Œä¸€åˆ‡æ–‡ä»¶çš†æ¨¡å—ã€‚é€šè¿‡loaderè½¬æ¢æ–‡ä»¶ï¼Œé€šè¿‡pluginæ³¨å…¥é’©å­ï¼Œæœ€åè¾“å‡ºç”±å¤šä¸ªæ¨¡å—ç»„åˆçš„æ–‡ä»¶ã€‚Webpackä¸“æ³¨æ„å»ºæ¨¡å—åŒ–é¡¹ç›®ã€‚

Webpackå¯ä»¥çœ‹ä½œæ˜¯æ¨¡å—æ‰“åŒ…æœºï¼šå®ƒåšçš„äº‹æƒ…æ˜¯ï¼Œåˆ†æä½ çš„é¡¹ç›®ç»“æ„ï¼Œæ‰¾åˆ°JavaScriptæ¨¡å—ä»¥åŠå…¶ä»–ä¸€äº›ä¸èƒ½è¢«æµè§ˆå™¨ç›´æ¥è¿è¡Œçš„æ‰©å±•è¯­éŸ³(å¦‚ï¼šScss,TypeScriptç­‰)ï¼Œå¹¶å°†å…¶æ‰“åŒ…ä¸ºåˆé€‚çš„æ ¼å¼ä»¥ä¾›æµè§ˆå™¨ä½¿ç”¨ã€‚

![webpack](https://wendaoshuai66.github.io/study/note/images/webpack.png)


###Webpackä¸Gruntã€Gulpçš„ä¸åŒï¼Ÿ

Grunt/Gulpæ˜¯ä¸€ç§èƒ½å¤Ÿä¼˜åŒ–å‰ç«¯å¼€å‘æµç¨‹çš„å·¥å…·ï¼Œè€ŒWebpackæ˜¯ä¸€ç§æ¨¡å—åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚


###å·¥ä½œæ–¹å¼ä¸åŒï¼š

Grunt/Gulpçš„å·¥ä½œæ–¹å¼æ˜¯ï¼šåœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‡æ˜æŸäº›æ–‡ä»¶è¿›è¡Œç±»ä¼¼ç¼–è¯‘/ç»„åˆ/å‹ç¼©ç­‰ä»»åŠ¡çš„å…·ä½“æ­¥éª¤ï¼Œä¹‹åå·¥å…·å¯ä»¥è‡ªåŠ¨å¸®ä½ å®Œæˆè¿™äº›ä»»åŠ¡

Webpackçš„å·¥ä½œæ–¹å¼æ˜¯ï¼šæŠŠé¡¹ç›®å½“ä½œæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œé€šè¿‡æŒ‡å®šçš„å…¥å£æ–‡ä»¶ï¼ŒWebpackä¼šä»è¿™ä¸ªå…¥å£æ–‡ä»¶å¼€å§‹æ‰¾åˆ°é¡¹ç›®æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨loaderå¤„ç†å®ƒä»¬ï¼Œæœ€åæ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ªæµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„JavaScriptæ–‡ä»¶

###æ„å»ºæ€è·¯ä¸åŒ

Grunt/Gulpéœ€è¦å°†æ•´ä¸ªå‰ç«¯æ„å»ºè¿‡ç¨‹æ‹†åˆ†æˆå¤šä¸ªtaskï¼Œåˆç†æ§åˆ¶æ‰€æœ‰taskçš„è°ƒç”¨å…³ç³»

Webpackéœ€è¦å®šä¹‰å¥½å…¥/å‡ºå£ï¼Œå¹¶éœ€è¦æ¸…æ¥šå¯¹äºä¸åŒç±»å‹èµ„æºåº”è¯¥ç”¨ä»€ä¹ˆloaderè§£æç¼–è¯‘


Grunt/Gulpæ˜¯åŸºäºä»»åŠ¡å’Œæµ(taskå’Œstream)çš„ã€‚ç±»ä¼¼jQuery,æ‰¾åˆ°ä¸€ä¸ª(æˆ–ä¸€ç±»)æ–‡ä»¶ï¼Œå¯¹å…¶åšä¸€ç³»åˆ—çš„é“¾å¼æ“ä½œï¼Œæ›´æ–°æµä¸Šçš„æ•°æ®ï¼Œæ•´æ¡é“¾å¼æ“ä½œæ„æˆäº†ä¸€ä¸ªä»»åŠ¡ï¼Œå¤šä¸ªä»»åŠ¡å°±æ„æˆäº†æ•´ä¸ªWebçš„æ„å»ºæµç¨‹ã€‚


Webpackæ˜¯åŸºäºå…¥å£çš„ã€‚Webpackä¼šè‡ªåŠ¨çš„é€’å½’è§£æå…¥å£æ‰€éœ€è¦åŠ è½½çš„æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç„¶åç”¨ä¸åŒçš„loaderæ¥å¤„ç†ä¸åŒçš„æ–‡ä»¶ï¼Œç”¨pulginæ‰©å±•WebpackåŠŸèƒ½ã€‚

###èƒŒæ™¯çŸ¥è¯†ä¸åŒ

Grunt/Gulpæ›´åƒæ˜¯åç«¯å¼€å‘è€…çš„æ€è·¯ï¼Œéœ€è¦å¯¹æ•´ä¸ªæµç¨‹äº†å¦‚æŒ‡æŒã€‚Webpackæ›´å€¾å‘äºå‰ç«¯å¼€å‘è€…çš„æ€è·¯ã€‚


##Webpackçš„æ„å»ºæµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ

Webpackçš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1.åˆå§‹åŒ–å‚æ•°ï¼šä»é…ç½®æ–‡ä»¶å’Œshellè¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—åˆ°æœ€ç»ˆå‚æ•°ï¼›

2.å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ–Compilerå¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„runæ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ï¼›

3.ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„entryæ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼›

4.ç¼–è¯‘æ¨¡å—ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„loaderå¯¹æ¨¡å—è¿›è¡Œç¼–è¯‘ã€‚å†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡æœ¬æ­¥éª¤çš„å¤„ç†ï¼›

5.å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬å››ä¸ªæ­¥éª¤ä½¿ç”¨loaderç¼–è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°æ¯ä¸ªæ¨¡å—è¢«ç¼–è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼›

6.è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„Chunkï¼Œå†æŠŠæ¯ä¸ªChunkè½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼šï¼›

7.è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®è®¤å¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™è¿›åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼›


åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpackä¼šåœ¨ç‰¹å®šçš„çš„æ—¶é—´ç‚¹å¹¿æ’­ç‰¹å®šçš„äº‹ä»¶ï¼Œæ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ã€‚å¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨Webpackæä¾›çš„APIæ”¹å˜Webpackçš„è¿è¡Œç»“æœã€‚


##åˆ†åˆ«ä»‹ç»bundleï¼Œchunkï¼Œmoduleæ˜¯ä»€ä¹ˆï¼Ÿ

bundleï¼šç”±Webpackæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶

chunkï¼šä»£ç å—ï¼Œwebpackåœ¨è¿›è¡Œæ¨¡å—çš„ä¾èµ–åˆ†æçš„æ—¶å€™ï¼Œä»£ç åˆ†å‰²å‡ºæ¥çš„ä»£ç å—

moduleï¼šæ˜¯å¼€å‘ä¸­çš„å•ä¸ªæ¨¡å—ï¼Œåœ¨Webpackä¸­ï¼Œä¸€åˆ‡çš†æ¨¡å—ï¼Œä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªæ–‡ä»¶

##ä»€ä¹ˆæ˜¯Loader?ä»€ä¹ˆæ˜¯Plugin?

loader: æ¨¡å—è½¬æ¢å™¨ï¼Œç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢

plugin: è‡ªå®šä¹‰webpackæ‰“åŒ…è¿‡ç¨‹çš„æ–¹å¼ï¼Œæ’ä»¶å«æœ‰applyå±æ€§çš„JavaScriptå¯¹è±¡ï¼Œapplyå±æ€§ä¼šè¢«webpack compilerè°ƒç”¨ï¼Œå¹¶ä¸”compilerå¯¹è±¡å¯ä»¥åœ¨æ•´ä¸ªç¼–è¯‘ç”Ÿå‘½å‘¨æœŸå†…è®¿é—®

##loaderå’Œpluginæœ‰å“ªäº›ä¸åŒï¼Ÿ

###ä¸åŒçš„ä½œç”¨

loaderç›´è¯‘ä¸ºâ€œåŠ è½½å™¨"ï¼ŒWebpackå°†ä¸€åˆ‡æ–‡ä»¶è§†ä¸ºæ¨¡å—ï¼Œä½†æ˜¯WebpackåŸç”Ÿåªèƒ½è§£æJavaScriptå’ŒJSONç±»å‹æ–‡ä»¶ã€‚å¦‚æœæƒ³åŠ è½½è§£æå…¶ä»–ç±»å‹æ–‡ä»¶ï¼Œå°±ä¼šç”¨åˆ°loaderã€‚æ‰€ä»¥loaderæ˜¯è®©Webpackæ‹¥æœ‰åŠ è½½å’Œè§£æéJavaScriptæ–‡ä»¶çš„èƒ½åŠ›

pluginç›´è¯‘ä¸ºâ€æ’ä»¶â€œï¼Œpluginå¯ä»¥æ‰©å±•Webpackçš„åŠŸèƒ½ï¼Œè®©Webpackå…·æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚åœ¨Webpackè¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­è®¸å¤šäº‹ä»¶ï¼Œpluginå¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡Webpackæä¾›çš„APIæ”¹å˜è¾“å‡ºç»“æœ


###ä¸åŒçš„ç”¨æ³•

loaderåœ¨module rulesä¸­é…ç½®ï¼Œä¹Ÿå°±è¯´å®ƒä½œä¸ºæ¨¡å—è§£æè§„åˆ™å­˜åœ¨ã€‚ç±»å‹ä¸ºArrayï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªObjectï¼Œé‡Œé¢æè¿°äº†ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶(test)ï¼Œä½¿ç”¨ä»€ä¹ˆåŠ è½½(loader)å’Œä½¿ç”¨çš„å‚æ•°(options)



pluginå•ç‹¬åœ¨pluginsä¸­å•ç‹¬é…ç½®ã€‚ç±»å‹ä¸ºArrayï¼Œæ¯é¡¹éƒ½æ˜¯ä¸€ä¸ªpluginçš„å®ä¾‹ï¼Œå‚æ•°æ˜¯é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥

##æœ‰å“ªäº›å¸¸è§çš„Loaderï¼Ÿ

file-loader: å°†æ–‡ä»¶è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡ç›¸å¯¹è·¯å¾„(url)å»å¼•ç”¨è¾“å‡ºçš„æ–‡ä»¶

url-loader: å’Œfile-loaderç±»ä¼¼ï¼Œä½†æ˜¯èƒ½åœ¨æ–‡ä»¶å¾ˆå°çš„æƒ…å†µä¸‹ï¼Œä»¥base64çš„æ–¹å¼å°†å†…å®¹æ³¨å…¥åˆ°ä»£ç ä¸­

image-loader: åŠ è½½å¹¶å‹ç¼©å›¾ç‰‡æ–‡ä»¶

babel-lodader: å°†ES6è½¬æˆES5

css-loader: åŠ è½½CSSï¼Œæ”¯æŒæ¨¡å—åŒ–/å‹ç¼©/æ–‡ä»¶å¯¼å…¥ç­‰ç‰¹æ€§

style-loaderï¼šæŠŠCSSä»£ç æ³¨å…¥åˆ°JavaScriptä¸­ï¼Œé€šè¿‡DOMæ“ä½œå»åŠ è½½CSS

eslint-loader: é€šè¿‡ESlintæ£€æŸ¥JavaScriptä»£ç 

##æœ‰å“ªäº›å¸¸è§çš„Pluginï¼Ÿ

define-plugin: å®šä¹‰ç¯å¢ƒå˜é‡

html-webpack-pulgin: ç”Ÿæˆåˆ›å»ºhtmlå…¥å£æ–‡ä»¶ï¼Œå¹¶å¼•ç”¨å¯¹åº”çš„å¤–éƒ¨èµ„æº

uglifyjs-plugin: é€šè¿‡Uglifyjså‹ç¼©JavaScriptä»£ç 

mini-css-extract-plugin: åˆ†ç¦»CSSæ–‡ä»¶

clean-webpack-plugin: åˆ é™¤æ‰“åŒ…æ–‡ä»¶

happypack: å®ç°å¤šçº¿ç¨‹åŠ é€Ÿç¼–è¯‘

##Tree Shaking

ä¸ºäº†ä½¿ç”¨tree shakingï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

1.ä½¿ç”¨ES2015è¯­æ³•(å³importå’Œexport)

2.åœ¨é¡¹ç›®package.jsonæ–‡ä»¶ä¸­ï¼Œæ·»åŠ sideEffectså…¥å£

3.å¼•å…¥ä¸€ä¸ªèƒ½å¤Ÿåˆ é™¤æœªå¼•ç”¨ä»£ç (dead code)çš„å‹ç¼©å·¥å…·(minifier)(ä¾‹å¦‚ï¼šUglifyJSPlugin)

###å°†æ–‡ä»¶æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨(side-effect-free)

è¿™ç§æ–¹å¼æ˜¯é€šè¿‡package.jsonçš„sideEffectså±æ€§æ¥å®ç°çš„ã€‚

```
{
  "sideEffects": false
}
```

ã€Œå‰¯ä½œç”¨ã€çš„å®šä¹‰æ˜¯ï¼Œåœ¨å¯¼å…¥æ—¶ä¼šæ‰§è¡Œç‰¹æ®Šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æš´éœ²ä¸€ä¸ªexportæˆ–å¤šä¸ªexportã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œä¾‹å¦‚polyfillï¼Œå®ƒå½±å“å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”é€šå¸¸ä¸æä¾›exportã€‚


æ³¨æ„ï¼Œä»»ä½•å¯¼å…¥çš„æ–‡ä»¶éƒ½ä¼šå—åˆ°tree shakingçš„å½±å“ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç±»ä¼¼css-loaderå¹¶å¯¼å…¥CSSæ–‡ä»¶ï¼Œåˆ™éœ€è¦å°†å…¶æ·»åŠ åˆ° side effect åˆ—è¡¨ä¸­ï¼Œä»¥å…åœ¨ç”Ÿäº§æ¨¡å¼ä¸­æ— æ„ä¸­å°†å®ƒåˆ é™¤ï¼š

```
{
  "sideEffects": ['*.css']
}
```

###å‹ç¼©è¾“å‡º

ä» webpack 4 å¼€å§‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ "mode" é…ç½®é€‰é¡¹è½»æ¾åˆ‡æ¢åˆ°å‹ç¼©è¾“å‡ºï¼Œåªéœ€è®¾ç½®ä¸º "production"ã€‚

ä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œæ¥å£ä¸­ä½¿ç”¨--optimize-minimizeæ ‡è®°ï¼Œæ¥ä½¿ç”¨UglifyjsPluginã€‚

## Code Splitting

code splittingçš„å¿…è¦æ€§

â¡ï¸ä¸è¿›è¡Œcode splittingï¼Œæ‰“åŒ…åå•æ–‡ä»¶æäº¤è¾ƒå¤§ï¼ŒåŠ è½½æ—¶é•¿è¾ƒé•¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ


â¡ï¸ä¸è¿›è¡Œcode splittingï¼Œç»å¸¸ä¿®æ”¹ä¸šåŠ¡ä»£ç ï¼Œé‡æ–°æ‰“åŒ…åï¼Œæµè§ˆå™¨ä¸èƒ½è¿›è¡Œç¼“å­˜ï¼Œå¯¼è‡´æ€§èƒ½è¾ƒå·®ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ

### åŒæ­¥ä»£ç 

````
import _ from 'lodash';
````

webpack.common.jsé…ç½®å¦‚ä¸‹ï¼š

```
....
optimization: {
  splitChunks: {
    chunks: 'all'
  }
}
....
```

é…ç½®åï¼Œä¼šå°†å…¬ç”¨ç±»åº“è¿›è¡Œæ‰“åŒ…ï¼Œç”Ÿæˆä¸€ä¸ªvendors~main.jsæ–‡ä»¶ã€‚

###å¼‚æ­¥ä»£ç 

```
function getComponent() {
  return import('lodash').then(({ default: _ }) => {
    var element = document.createElement('div');
    element.innerHTML = _.join(['Clear', 'love'], '');
    return element;
  })
}

getComponent().then(element => {
  document.body.appendChild(element);
})
```

##webpack-dev-serverå’ŒhttpæœåŠ¡å™¨å¦‚nginxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

webpack-dev-serverä½¿ç”¨å†…å­˜æ¥å­˜å‚¨Webpackå¼€å‘ç¯å¢ƒä¸‹æ‰“åŒ…çš„æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ¨¡å—çƒ­æ›´æ–°ï¼Œå®ƒæ¯”ä¼ ç»Ÿçš„httpæœåŠ¡å¯¹å¼€å‘æ›´åŠ ç®€å•é«˜æ•ˆã€‚

##ä»€ä¹ˆ æ˜¯æ¨¡å—çƒ­æ›´æ–°ï¼Ÿ

æ¨¡å—çƒ­æ›´æ–°æ˜¯Webpackæ˜¯çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå¯ä»¥ä½¿å¾—ä»£ç ä¿®æ”¹ä»¥åä¸éœ€åˆ·æ–°æµè§ˆå™¨å°±å¯ä»¥æ›´æ–°ï¼Œæ˜¯é«˜çº§ç‰ˆçš„è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ã€‚devServeré€šè¿‡hotå±æ€§å¯ä»¥æ§åˆ¶æ¨¡å—çƒ­æ›´æ›¿ã€‚

##é€šè¿‡é…ç½®æ–‡ä»¶

```
const webpack = require('webpack');
const path = require('path');
let env = process.env.NODE_ENV == "development" ? "development" : "production";
const config = {
  mode: env,
  devServer: {
     hot:true
  },
  plugins: [
     new webpack.HotModuleReplacementPlugin(), //çƒ­åŠ è½½æ’ä»¶
  ]
}
module.exports = config;
```

###é€šè¿‡å‘½ä»¤è¡Œ

```
"script": {
  "start": "NODE_EVN=development webpack-dev-server --config webpack-devlop-config.js --hot"
}
```



